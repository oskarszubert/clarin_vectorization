var topa_title="WordPress 2.1 i same problemy #8230;"; var topa_link="http%3A%2F%2Ftomasz.topa.pl%2Fwordpress-21-i -same-problemy.html"; WordPress 2.1 i same problemy…    !-- google_ad_client = "pub-5199944487334506"; google_ad_slot = "4898454205"; google_ad_width = 234; google_ad_height = 60; //--                                               !-- google_ad_client = "ca-pub-5199944487334506"; google_ad_slot = "9221153712"; google_ad_width = 300; google_ad_height = 250; //-- Dziękuję, więcej się tak nie dam nabrać. Ściągnąłem nowego WordPressa (2.1), zaktualizowałem system używany tu na weblogu, pochodziło przez noc (zerowy ruch), a potem… zaczęły się jazdy. O problemach dowiedziałem się się maila od administratorów Site5. W załączniku wyciąg z logów, gdzie były dokładnie zaznaczone miejsca, gdy moje konto generowało 97% obciążenie czteroprocesorowej maszyny! Dobrze, że skończyło się tylko na ustawieniu odpowiedniego chmoda odcinającego PHP dostęp do plików (stąd wszystkie Error 403), a nie na całkowitej deaktywacji konta. Zalogowałem się więc na SSH i zacząłem przeglądać pliki error_log dla wszystkich podpiętych domen w poszukiwaniu przyczyn nadmiernego obciążenia. Na początku myślałem, że to problem ze stroną Łukasza, zwłaszcza, że od czasu wdrożenia AJAX-owych bajerów error_log strasznie się rozrósł. Błąd został błyskawicznie naprawiony – ot pierdoła, która generowała tylko błąd związany z nieprawidłową liczbą argumentów funkcji, od jej działania nie zależało nic innego, czyli nie miało prawa generować aż takiego zonka… Czyli to nie to… Nic, mamy konto shellowe, więc trzeba z niego korzystać. Odpalamy top -u i monitorujemy zużycie zasobów. Zablokowałem wszystkie strony na moim koncie, poczekałem aż load się ustabilizuje i po kolei przywracałem kolejne serwisy. Gdy doszedłem do webloga, prawie poleciałem z krzesła. Statsy faktycznie pokazywały czarno na białym (blah, biało na czarnym – konsola w końcu ;)), że wejście na www.tomasz.topa.pl skutkowało, że proces php faktycznie zżera średnio 70-90% mocy serwera! I to ma być ten nowy zoptymalizowany kod? Wróciłem do wcześniejszych wersji 2.0.x, wszystko działa, konto, na którym działa kilka sporych stron znowu spokojnie śmiga na współdzielonym hostingu. Hm… Zaaaraaz… wszystko działa? Nie do jasnej ciasnej, nie wszystko!! Gdzie jest te „ponad 550 poprawek” ponoć zawartych w nowej wersji? Coś mi się szybko przypomniało stare prawo Murphy’ego:  Nowa wersja oprogramowania poprawia stare błędy i dodaje drugie tyle nowych.  Instalator WP2.1 (czy jak tam nazwać skrypt odpowiedzialny za upgrade) postanawia bowiem trochę zmodernizować strukturę danych w Twoim WordPressie. Oczywiście wszystko zgodnie z zasadą: It’s not a bug. It’s a feature.:  Wszystkie strony statyczne („pages”) zamienia na wpisy przydzielone jedynie do głównej kategorii Pojawiają się też nowe spisy będące… hm… nie wiem czym. Ot pojawiły się kolejne wpisy Kategorie linków nagle się znajdują wśród kategorii wpisów Niektóre pluginy odmawiają posłuszeństwa Po powrocie do wersji 2.0.x przestają działać AJAXowe bajerki w panelu Jakoś nie zauważyłem działania nowego edytora WYSIWYG Tyle zauważyłem na razie… Ech, chyba po piątkowym kolokwium postawię na czystko instalkę WP 2.0.7… A, i żeby nie było: nie jestem jedyną osobą, która narzeka na nowego WP, więc to chyba nie jest kwestia mojej nieudolności w aktualizacji. Na WP2.1 skarży się też RAFi czy Paweł Opydo. Na WordPress Support Forums też pojawiło się sporo zgłoszeń o błędach i pytań, skąd pobrać WP2.0.7 ;) Postanowienie na pewno takie: nigdy więcej zautomatyzowanych instalatorów i instalowania nowych wersji softu wcześniej niż po tygodniu od publikacji. Blah… Wpis opublikowany 24 stycznia 2007Tagi: awarie, blog, everything, homepage, hosting, internet, problemy, weblog, wordpressKategorie: Bez kategorii 