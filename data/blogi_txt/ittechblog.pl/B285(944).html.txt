Tomasz Fiedoruk    - Właściciel serwisu - Business Strategy Development Expert w kilku firmach i w życiu. Ewangelista nowych technologii i innowacji.   @iTomek   Email Tomasz Fiedoruk, 28 maja 2010, 8:04   2   SuperServer 5015A-PHF: Cz.2 – Serwer dedykowany Atom vs. VPS – co lepsze? Jest to druga część testu serwera SuperServer 5015A-PHF jaki przeprowadziliśmy, z pierwszą częścią można zapoznać się tu: Test serwera SuperServer 5015A-PHF: Cz.1 – Panel administracyjny. Zapraszamy do lektury.Druga część: Serwer dedykowany Atom vs. VPS – co lepsze? Domyślam się, że wszyscy, którzy stanęli na krawędzi limitów hostingu wirtualnego i są zmuszeni przenieść się na własny serwer stanęli przed pytaniem: Co będzie lepiej dopasowane do moich potrzeb – własny fizyczny serwer dedykowany czy VPS? Zgodnie z zapowiedziami przedstawiamy Wam test serwera SuperServer 5015A-PHF w dhosting.pl. Żeby oszczędzić bólu głowy wielu osobom postaram się rozważyć ten temat biorąc pod uwagę nie tylko wydajność samej platformy, ale również możliwości konfiguracji programowej. Każdy ma swoje zalety i wady. W teście celowo wezmą udział serwer dedykowany oparty o budżetowe procesy Intel Atom oraz serwer VPS o podobnych parametrach, by jak najlepiej ukazać różnice (o ile w ogóle one istnieją?). Do walki staną: 1) Serwer dedykowany: CPU: Intel(R) Atom(TM) CPU D510   @ 1.66GHz (2x 1,66GHz + HT) Pamięć: 4GB Ram HDD: 2x 250GB 5,4k rpm (brak macierzy, pod koniec artykułu postaram się opisać zalety jakie mogły by wynikać z podparcia się np. software raid) 2) VPS root: CPU: 8xIntel(R) Xeon(R) CPU E5420  @ 2.50GHz (na potrzeby testu utworzono serwer o gwarantowanej mocy 2x 1,66GHz) Pamięć: 4GB Ram HDD: 8GB na macierzy zbudowanej na dyskach SAS-2 Małe info o zastosowanych dyskach. W omawianych rozwiązaniach wykorzystano skrajnie różne technologie dysków twardych – zwykłe, wręcz desktopowe dyski SATA w platformie ATOM (SATA 3 Gb/s 7200 obr/min) i  szybkie, nowoczesne dyski SAS w VPS (SAS-2 6 Gb/s 15000 obr/min). Kilka słów wyjaśnienia. Obydwie platformy są dostarczone do testów przez naszego obecnego partnera technologicznego, firmę dhosting.pl. Pierwszy serwer (serwer dedykowany oparty o procesory Intel Atom) firma dopiero zamierza wprowadzić do swojej oferty, prawdopodobnie zrobi to na dniach. Druga użyta do testów opcja (VPS) nie widnieje w ofercie firmy, została specjalnie dla nas utwrzona na czas testów. Wydajność: Teoretyzując: Serwer dedykowany należy tylko do nas i nie dzielimy jego zaosbów pośród innych użytkowników, a więc nie wpływa tutaj żaden czynnik zewnętrzny.   VPS działa na zasadzie miękkich limitów, czyli moc porównywalna do około 1,6 GHz jest przydzielana jako minimalna wartość. Jeśli maszyna – matka nie jest w danej chwili obciążona, pojedynczy VPS otrzymuje całą jej moc.  Dyski użyte na serwerze matce są z pewnością dużo wydajniejsze i mniej awaryjne niż te, które mamy w tanim serwerze dedykowanym . Jednak czy zachowają one swoje właściwości gdy zostaną współdzielone pośród N klientów? Testy: Zostanie tu użyte oprogramowanie i nazwie unixbenchmark (unixbench-4.1.0-wht ). Serwer dedykowany: Start Benchmark Run: śro, 12 maj 2010, 20:00:44 CEST 20:00:44 up 1 day, 21:43,  1 user,  load average: 0.00, 0.00, 0.00 End Benchmark Run: śro, 12 maj 2010, 20:10:50 CEST 20:10:50 up 1 day, 21:53,  1 user,  load average: 17.78, 6.66, 2.79 VPS: Start Benchmark Run: Wed May 12 18:00:52 UTC 2010 18:00:52 up 1 day, 18:22,  1 user,  load average: 0.00, 0.00, 0.00 End Benchmark Run: Wed May 12 18:17:31 UTC 2010 18:17:31 up 1 day, 18:39,  1 user,  load average: 9.61, 4.51, 2.38        Zadanie Serwer dedykowany VPS   Dhrystone 2 using register variables 135.0 128.4   Double-Precision Whetstone 43.1 169.7   Execl Throughput 164.5 209.1   File Copy 1024 bufsize 2000 maxblocks 314.9 1037.9   File Copy 256 bufsize 500 maxblocks 225.6 655.1   File Read 4096 bufsize 8000 maxblocks 549.0 493.0   Pipe-based Context Switching 142.7 178.4 Pipe Throughput 84.7 81.2   Process Creation 161.2 196.3   Shell Scripts (8 concurrent) 115.6 208.7   System Call Overhead 256.1 70.4   Podsumowanie 163.0 221.8     Z tabeli doskonale możemy odczytać, że VPS lepiej radzi sobie z poszczególnymi etapami testu, osiąga również lepszy sumaryczny wynik. Więc w dużej mierze rozwialiśmy wątpliwości w temacie wydajności serwera dedykowanego kontra VPS. Warto jednak zauważyć, że to serwer dedykowany potrzebował mniej czasu na wykonanie benchmarku, a różnica w czasie to około 70% na korzyść platformy opartej o procesor Intel Atom! Postanowiłem jednak, że wykonam jeszcze 1 mało skomplikowany test w środowisku web-hostingowym (bardzo uproszczonym). Środowisko: System Operacyjny: Debian Lenny Serwer http: Apache 2.2.9 Serwer SQL: MySQL-5.0.51a PHP: PHP 5.2.6-1+lenny8 with Suhosin-Patch 0.9.6.2 Odrobinę bardziej szczegółowe informacje: Apache działa jako mpm-prefork, php działa jako moduł apache. Do php nie został dograny żaden  moduł opcache. Przetestowany pod względem wydajności zostanie czysty blog WordPress, test zostanie wykonany z maszyny lokalnej. Do wykonania benchmarków wykorzystam ab – apachebenchmark. ;) ab -n 1000 -c 5        Platforma Serwer Dedykowany VPS   Time taken for tests 399.918 [s] 322.721 [s]   Time per request 399.918 [ms] 322.721 [ms]   Requests per second 2,50 /[s] 3,10 /[s] Gdzie: [s] – sekund [ms] – milisekund  (sekunda*10-3) /[s] – na sekundę Wartość pierwsza i druga różni się tylko przedrostkiem mili ze względu na to, że w testach zbierałem informacje dla 1000 zapytań. Tak więc jak możemy wyczytać z tabeli tutaj lepszy okazał się również serwer VPS. Myślę, że kwestię wydajności mamy rozstrzygniętą na korzyść serwera VPS, gdyż osiągnął on lepsze wyniki w obydwu testach. Jednak nie zawsze te kilka procent na korzyść jednego czy drugiego jest istotne i w dalszej części artykułu postaram się wyczerpać inne istotne kwestie, które należy poruszyć podczas wyboru serwera dla siebie. Myślę, że warto rozważyć również inne aspekty, w których różnią się od siebie te dwie platformy i wyciągnąć jakieś wnioski. Korzyści serwera dedykowanego:  Przede wszystkim w przypadku serwera dedykowanego mamy dostępne 2 dyski twarde i możemy dostosować sobie indywidualnie, według potrzeb macierz poprzez zastosowanie software raid1 lub raid0. Jest to spora zaleta, gdyż w niektórych zastosowaniach może to znacznie poprawić wydajność dysku, nawet do 100%. Nie ogranicza nas żaden narzut wirtualizacji  – jesteśmy panami własnego serwera. Zasoby serwera są niezmienne, cały czas posiadamy taką samą moc procesora, taki sam priorytet zapisu na dyskach. Po prostu wiemy na czym stoimy. Dodatkowym atutem jaki dane mi było testować przez chwilę jest IMPI (o którym pisaliśmy w częsci pierwszej testu) – czyli taki przydatny bajer, którego istnienie bardzo mile mnie zaskoczyło w tej budżetowej konstrukcji. W skrócie jest to system, dzięki któremu w kryzysowej sytuacji możemy odratować system i przywrócić go do działania, bez potrzeby zdawania się łaskę administratorów serwerowni. Więcej na jego temat znajdziecie w internecie! Korzyści VPS: W testach wypadł lepiej i możemy wyciągnąć wniosek, że jest w stanie obsłużyć większy ruch ze względu na lepszy poziom skalowalności jaki jest w stanie osiągnąć. Nie musimy się martwić o awarie dysków twardych, odbudowanie macierzy, gdyż tym zajmuje się firma w której mamy wykupiony serwer. Bezproblemowe przejście na wyższe parametry, ze względu na zwirtualizowane zasoby serwera. Co jest ogromnym plusem, gdyż można dosłownie w mgnieniu oka, po krótkim kontakcie z providerem, zwiększyć czy to pojemność serwera, pamięć dynamiczną czy czas procesora! Nie jest to już takie łatwe w przypadku serwera dedykowanego, gdyż wymaga to wtedy co najmniej odłączenia go od zasilania i wymiany podzespołów, a w skrajnych wypadkach jest to całkowicie nie możliwe i wymaga przejścia na inną platformę sprzętową. Po tym krótkim porównaniu i słownym określenie zalet i wad każdej z platform, wybór serwera powinien być chociaż odrobinę prostszy i lepiej przemyślany. VPS vs. Atom – Ceny … Konfiguracje mieliśmy identyczne jeśli chodzi o teoretyczną moc i RAM. Cena VPS o podanych wyżej parametrach to koszt 480-500 zł netto (orientacyjnie, ponieważ taki VPS opierałby się na indywidualnych ustaleniach z dhosting), tymczasem ceny Atoma wyglądają następująco. Cenowo ponad 2.5x niższa oferta. :) Sporo! Oczywiście VPS na tanim PC, a nie na markowym sprzęcie kosztowałby mniej, jednak sądzę, że w porównaniu VPS na PC vs. własny Atom – Atom zdecydowanie wygrywa.  Artykuł dla ittechblog.pl przygotował gościnnie i debiutancko: Mateusz Adach vel Malu mateusz.adach[at]gmail[dot]com 